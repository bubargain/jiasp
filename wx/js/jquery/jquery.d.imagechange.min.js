
try{document.execCommand('BackgroundImageCache',false,true);}catch(e){}
(function($){jQuery.fn.extend({d_imagechange:function(setting){var config=$.extend({bg:true,title:true,desc:true,btn:true,repeat:'no-repeat',bgColor:'#000',bgOpacity:.5,bgHeight:40,titleSize:14,titleFont:'Verdana,宋体',titleColor:'#FFF',titleTop:4,titleLeft:4,descSize:12,descFont:'Verdana,宋体',descColor:'#FFF',descTop:2,descLeft:4,btnColor:'#FFF',btnOpacity:.5,btnFont:'Verdana',btnFontSize:12,btnFontColor:'#000',btnText:true,btnWidth:15,btnHeight:15,btnMargin:4,btnTop:4,playTime:2000,animateTime:500,animateStyle:'o',width:300,height:200},setting);return $(this).each(function(){var _this=$(this);var _w=config.width||_this.width();var _h=config.height||_this.height();var _n=config.data.length;var _i=0;_this.empty().css('overflow','hidden').width(_w).height(_h);if(config.bg){$('<div />').appendTo(_this).width(_w).height(config.bgHeight).css('background-color',config.bgColor).css('opacity',config.bgOpacity).css('position','absolute').css('marginTop',_h-config.bgHeight).css('zIndex',3333);}
var _textArea=$('<div />').appendTo(_this).width(_w).height(config.bgHeight).css('position','absolute').css('marginTop',_h-config.bgHeight).css('zIndex',6666);var _btnArea=$('<div />').appendTo(_this).width(_w).height(config.bgHeight).css('position','absolute').css('marginTop',_h-config.bgHeight).css('marginLeft',_w-(config.btnWidth+config.btnMargin)*_n).css('zIndex',9999).css('display',config.btn?'block':'none');$('<div />').appendTo(_this);var _imgArea=$('<div />').appendTo(_this).width('x,show-x'.indexOf(config.animateStyle)!=-1?_w*_n:_w).height('y,show-y'.indexOf(config.animateStyle)!=-1?_h*_n:_h);$.each(config.data,function(i,n){$('<a />').appendTo(_imgArea).width(_w).height(_h).attr('href',n.href?n.href:'').attr('target',n.target?n.target:'').css('display','block').css('background-repeat',config.repeat).css('display','block').html("<img src='"+n.src+"' width='"+_w+"' />").css('float','x,show-x'.indexOf(config.animateStyle)!=-1?'left':'');if(config.title){$('<b />').appendTo(_textArea).html(n.title?n.title:'').css('display',i==0?'block':'none').css('fontSize',config.titleSize).css('fontFamily',config.titleFont).css('color',config.titleColor).css('marginTop',config.titleTop).css('marginLeft',config.titleLeft);}
if(config.desc){$('<p />').appendTo(_textArea).html(n.desc?n.desc:'').css('display',i==0?'block':'none').css('fontSize',config.descSize).css('fontFamily',config.descFont).css('color',config.descColor).css('marginTop',config.descTop).css('marginLeft',config.descLeft);}
$('<a />').appendTo(_btnArea).width(config.btnWidth).height(config.btnHeight).html(config.btnText?i+1:'').css('fontSize',config.btnFontSize).css('fontFamily',config.btnFont).css('textAlign','center').css('display','block').css('float','left').css('overflow','hidden').css('marginTop',config.btnTop).css('marginRight',config.btnMargin).css('background-color',config.btnColor).css('opacity',i==0?1:config.btnOpacity).css('color',config.btnFontColor).css('cursor','pointer')});var _bs=_btnArea.children('a');var _ts=_textArea.children('b');var _ds=_textArea.children('p');var _is=_imgArea.children('a');if('o,show,none'.indexOf(config.animateStyle)!=-1){_is.not(':first').hide();_is.css('position','absolute');}
_bs.click(function(){var ii=_bs.index(this);if(ii==_i){return;}
_ts.eq(_i).css('display','none');_ts.eq(ii).css('display','block');_ds.eq(_i).css('display','none');_ds.eq(ii).css('display','block');_bs.eq(_i).css('opacity',config.bgOpacity);_bs.eq(ii).css('opacity',1)
switch(config.animateStyle){case'o':_is.eq(_i).fadeOut(config.animateTime);_is.eq(ii).fadeIn(config.animateTime);break;case'x':_imgArea.animate({marginLeft:-ii*_w},config.animateTime);break;case'y':_imgArea.animate({marginTop:-ii*_h},config.animateTime);break;case'show':case'show-x':case'show-y':_is.eq(_i).hide(config.animateTime);_is.eq(ii).show(config.animateTime);break;case'none':_is.eq(_i).hide();_is.eq(ii).show();break;}
_i=ii;});var _play=setInterval(play,config.playTime);function play(){_bs.eq((_i+1)%_n).click()}
_this.mouseover(function(){clearInterval(_play);});_this.mouseout(function(){_play=setInterval(play,config.playTime);});});}});})(jQuery);